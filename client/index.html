<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Disaster Response Coordination Platform - Real-time disaster management and resource coordination">
  <title>Disaster Response Coordination Platform</title>
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="/socket.io/socket.io.js"></script>
</head>
<body>

  <!-- Header -->
  <header class="header">
    <div class="header-inner">
      <div class="logo">
        <span>Disaster Response Coordination Platform</span>
      </div>
      <div class="header-right">
        <div class="connection-status">
          <span class="status-dot" id="wsStatus"></span>
          <span id="wsStatusText">Disconnected</span>
        </div>
        <div class="user-badge">
          ğŸ‘¤
          <select id="userSelect">
            <option value="netrunnerX">netrunnerX (Admin)</option>
            <option value="reliefAdmin">reliefAdmin (Admin)</option>
            <option value="citizen1" selected>citizen1</option>
            <option value="volunteer1">volunteer1</option>
          </select>
        </div>
      </div>
    </div>
  </header>

  <!-- Navigation -->
  <nav class="nav-tabs">
    <button class="nav-tab active" data-tab="dashboard" id="nav-dashboard">ğŸ“Š Dashboard</button>
    <button class="nav-tab" data-tab="disasters" id="nav-disasters">ğŸŒªï¸ Disasters</button>
    <button class="nav-tab" data-tab="reports" id="nav-reports">ğŸ“‹ Reports</button>
    <button class="nav-tab" data-tab="social" id="nav-social">ğŸ“± Social Feed</button>
    <button class="nav-tab" data-tab="resources" id="nav-resources">ğŸ—ºï¸ Resources</button>
    <button class="nav-tab" data-tab="updates" id="nav-updates">ğŸ“° Official Updates</button>
    <button class="nav-tab" data-tab="geocode" id="nav-geocode">ğŸ“ Geocoding</button>
    <button class="nav-tab" data-tab="verify" id="nav-verify">ğŸ” Verification</button>
  </nav>

  <!-- Toast Container -->
  <div class="toast-container" id="toastContainer"></div>

  <!-- Main Content -->
  <main class="main-content">

    <!-- ===== DASHBOARD ===== -->
    <section class="tab-content active" id="tab-dashboard">
      <div class="stats-bar">
        <div class="stat-card">
          <div class="stat-value" id="statDisasters">0</div>
          <div class="stat-label">Active Disasters</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="statReports">0</div>
          <div class="stat-label">Reports Filed</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="statResources">0</div>
          <div class="stat-label">Resources</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="statAlerts">0</div>
          <div class="stat-label">Priority Alerts</div>
        </div>
      </div>

      <div class="grid-2">
        <div class="card">
          <div class="card-header">
            <div class="card-title">ğŸŒªï¸ Recent Disasters</div>
          </div>
          <div id="dashDisasterList" class="disaster-list">
            <div class="empty-state"><div class="empty-state-icon">ğŸŒ</div><div class="empty-state-text">No disasters recorded</div></div>
          </div>
        </div>
        <div class="card">
          <div class="card-header">
            <div class="card-title">ğŸ“± Live Social Feed</div>
            <span class="card-badge priority-critical">LIVE</span>
          </div>
          <div id="dashSocialFeed" class="disaster-list">
            <div class="empty-state"><div class="empty-state-icon">ğŸ“¡</div><div class="empty-state-text">Select a disaster to view feed</div></div>
          </div>
        </div>
      </div>

      <div class="card" style="margin-top: 20px;">
        <div class="card-header">
          <div class="card-title">ğŸ—ºï¸ Resource Map</div>
        </div>
        <div id="map"></div>
      </div>
    </section>

    <!-- ===== DISASTERS ===== -->
    <section class="tab-content" id="tab-disasters">
      <div class="grid-2">
        <div class="card">
          <div class="card-header">
            <div class="card-title">â• Create / Edit Disaster</div>
          </div>
          <form id="disasterForm">
            <input type="hidden" id="disasterEditId">
            <div class="form-group">
              <label class="form-label">Title</label>
              <input class="form-input" id="disasterTitle" placeholder="e.g. NYC Flood" required>
            </div>
            <div class="form-group">
              <label class="form-label">Location Name</label>
              <input class="form-input" id="disasterLocation" placeholder="e.g. Manhattan, NYC">
            </div>
            <div class="form-group">
              <label class="form-label">Description</label>
              <textarea class="form-textarea" id="disasterDesc" placeholder="Describe the disaster..."></textarea>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label class="form-label">Latitude</label>
                <input class="form-input" id="disasterLat" type="number" step="any" placeholder="40.7128">
              </div>
              <div class="form-group">
                <label class="form-label">Longitude</label>
                <input class="form-input" id="disasterLng" type="number" step="any" placeholder="-74.0060">
              </div>
            </div>
            <div class="form-group">
              <label class="form-label">Tags (comma separated)</label>
              <input class="form-input" id="disasterTags" placeholder="flood, urgent">
            </div>
            <div style="display: flex; gap: 8px;">
              <button type="submit" class="btn btn-primary">ğŸ’¾ Save Disaster</button>
              <button type="button" class="btn btn-secondary" onclick="resetDisasterForm()">ğŸ”„ Reset</button>
            </div>
          </form>
        </div>
        <div class="card">
          <div class="card-header">
            <div class="card-title">ğŸ“‹ All Disasters</div>
            <div style="display:flex;gap:8px;">
              <input class="form-input" id="disasterTagFilter" placeholder="Filter by tag..." style="width: 150px;">
              <button class="btn btn-secondary btn-sm" onclick="loadDisasters()">ğŸ”</button>
            </div>
          </div>
          <div id="disasterList" class="disaster-list">
            <div class="loading"><div class="spinner"></div> Loading...</div>
          </div>
        </div>
      </div>
    </section>

    <!-- ===== REPORTS ===== -->
    <section class="tab-content" id="tab-reports">
      <div class="grid-2">
        <div class="card">
          <div class="card-header">
            <div class="card-title">ğŸ“ Submit Report</div>
          </div>
          <form id="reportForm">
            <div class="form-group">
              <label class="form-label">Disaster</label>
              <select class="form-select" id="reportDisasterId" required>
                <option value="">Select disaster...</option>
              </select>
            </div>
            <div class="form-group">
              <label class="form-label">Content</label>
              <textarea class="form-textarea" id="reportContent" placeholder="Describe the situation..." required></textarea>
            </div>
            <div class="form-group">
              <label class="form-label">Image URL (optional)</label>
              <input class="form-input" id="reportImageUrl" placeholder="https://example.com/photo.jpg">
            </div>
            <button type="submit" class="btn btn-primary">ğŸ“¤ Submit Report</button>
          </form>
        </div>
        <div class="card">
          <div class="card-header">
            <div class="card-title">ğŸ“‹ Filed Reports</div>
          </div>
          <div id="reportList" class="disaster-list">
            <div class="empty-state"><div class="empty-state-icon">ğŸ“‹</div><div class="empty-state-text">No reports filed yet</div></div>
          </div>
        </div>
      </div>
    </section>

    <!-- ===== SOCIAL MEDIA ===== -->
    <section class="tab-content" id="tab-social">
      <div class="grid-2">
        <div class="card">
          <div class="card-header">
            <div class="card-title">ğŸ“± Social Media Feed</div>
            <span class="card-badge priority-critical">REAL-TIME</span>
          </div>
          <div class="form-group">
            <label class="form-label">Select Disaster</label>
            <select class="form-select" id="socialDisasterId">
              <option value="">Select disaster...</option>
            </select>
          </div>
          <div class="form-group">
            <label class="form-label">Filter by tags</label>
            <input class="form-input" id="socialTags" placeholder="flood, rescue">
          </div>
          <button class="btn btn-primary" onclick="loadSocialMedia()" style="margin-bottom: 16px;">ğŸ”„ Fetch Posts</button>
          <div id="socialFeed" class="disaster-list">
            <div class="empty-state"><div class="empty-state-icon">ğŸ“¡</div><div class="empty-state-text">Select a disaster and fetch posts</div></div>
          </div>
        </div>
        <div class="card">
          <div class="card-header">
            <div class="card-title">ğŸš¨ Priority Alerts</div>
          </div>
          <div id="alertFeed" class="disaster-list">
            <div class="empty-state"><div class="empty-state-icon">ğŸ””</div><div class="empty-state-text">No priority alerts</div></div>
          </div>
        </div>
      </div>
    </section>

    <!-- ===== RESOURCES ===== -->
    <section class="tab-content" id="tab-resources">
      <div class="grid-2">
        <div class="card">
          <div class="card-header">
            <div class="card-title">â• Add Resource</div>
          </div>
          <form id="resourceForm">
            <div class="form-group">
              <label class="form-label">Disaster</label>
              <select class="form-select" id="resourceDisasterId" required>
                <option value="">Select disaster...</option>
              </select>
            </div>
            <div class="form-group">
              <label class="form-label">Resource Name</label>
              <input class="form-input" id="resourceName" placeholder="e.g. Red Cross Shelter" required>
            </div>
            <div class="form-group">
              <label class="form-label">Location Name</label>
              <input class="form-input" id="resourceLocationName" placeholder="e.g. Lower East Side, NYC">
            </div>
            <div class="form-group">
              <label class="form-label">Type</label>
              <select class="form-select" id="resourceType" required>
                <option value="shelter">ğŸ  Shelter</option>
                <option value="hospital">ğŸ¥ Hospital</option>
                <option value="food">ğŸ² Food</option>
                <option value="water">ğŸ’§ Water</option>
                <option value="supplies">ğŸ“¦ Supplies</option>
                <option value="evacuation">ğŸš Evacuation</option>
                <option value="other">ğŸ“Œ Other</option>
              </select>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label class="form-label">Latitude</label>
                <input class="form-input" id="resourceLat" type="number" step="any" placeholder="40.7128">
              </div>
              <div class="form-group">
                <label class="form-label">Longitude</label>
                <input class="form-input" id="resourceLng" type="number" step="any" placeholder="-74.0060">
              </div>
            </div>
            <button type="submit" class="btn btn-primary">ğŸ“ Add Resource</button>
          </form>
        </div>
        <div class="card">
          <div class="card-header">
            <div class="card-title">ğŸ” Nearby Resources</div>
          </div>
          <div class="form-row" style="margin-bottom: 12px;">
            <div class="form-group">
              <label class="form-label">Search Lat</label>
              <input class="form-input" id="searchLat" type="number" step="any" placeholder="40.7128">
            </div>
            <div class="form-group">
              <label class="form-label">Search Lon</label>
              <input class="form-input" id="searchLon" type="number" step="any" placeholder="-74.0060">
            </div>
          </div>
          <div class="form-group">
            <label class="form-label">Disaster</label>
            <select class="form-select" id="searchResourceDisasterId">
              <option value="">Select disaster...</option>
            </select>
          </div>
          <button class="btn btn-primary" onclick="searchNearbyResources()" style="margin-bottom: 16px;">ğŸ” Search Nearby</button>
          <div id="resourceList" class="disaster-list">
            <div class="empty-state"><div class="empty-state-icon">ğŸ—ºï¸</div><div class="empty-state-text">Search for nearby resources</div></div>
          </div>
        </div>
      </div>
      <div class="card" style="margin-top: 20px;">
        <div class="card-header"><div class="card-title">ğŸ—ºï¸ Resource Map</div></div>
        <div id="resourceMap" style="width:100%;height:400px;border-radius:16px;border:1px solid var(--border-color);overflow:hidden;"></div>
      </div>
    </section>

    <!-- ===== OFFICIAL UPDATES ===== -->
    <section class="tab-content" id="tab-updates">
      <div class="card">
        <div class="card-header">
          <div class="card-title">ğŸ“° Official Updates</div>
        </div>
        <div class="form-group">
          <label class="form-label">Select Disaster</label>
          <select class="form-select" id="updatesDisasterId">
            <option value="">Select disaster...</option>
          </select>
        </div>
        <button class="btn btn-primary" onclick="loadOfficialUpdates()" style="margin-bottom: 16px;">ğŸ“° Fetch Updates</button>
        <div id="updatesList" class="disaster-list">
          <div class="empty-state"><div class="empty-state-icon">ğŸ“°</div><div class="empty-state-text">Select a disaster to fetch official updates</div></div>
        </div>
      </div>
    </section>

    <!-- ===== GEOCODING ===== -->
    <section class="tab-content" id="tab-geocode">
      <div class="grid-2">
        <div class="card">
          <div class="card-header">
            <div class="card-title">ğŸ“ Location Extraction & Geocoding</div>
          </div>
          <form id="geocodeForm">
            <div class="form-group">
              <label class="form-label">Description (Gemini AI extracts locations)</label>
              <textarea class="form-textarea" id="geocodeDesc" placeholder="e.g. Heavy flooding reported in Manhattan, NYC near the Brooklyn Bridge area..." style="min-height: 100px;"></textarea>
            </div>
            <div style="text-align:center;color:var(--text-muted);margin:8px 0;">â€” OR â€”</div>
            <div class="form-group">
              <label class="form-label">Direct Location Name</label>
              <input class="form-input" id="geocodeLocation" placeholder="e.g. Manhattan, NYC">
            </div>
            <button type="submit" class="btn btn-primary">ğŸŒ Geocode</button>
          </form>
          <div id="geocodeResults"></div>
        </div>
        <div class="card">
          <div class="card-header">
            <div class="card-title">ğŸ—ºï¸ Geocoded Locations</div>
          </div>
          <div id="geocodeMap" style="width:100%;height:400px;border-radius:16px;border:1px solid var(--border-color);overflow:hidden;"></div>
        </div>
      </div>
    </section>

    <!-- ===== VERIFICATION ===== -->
    <section class="tab-content" id="tab-verify">
      <div class="grid-2">
        <div class="card">
          <div class="card-header">
            <div class="card-title">ğŸ” Image Verification (Gemini AI)</div>
          </div>
          <form id="verifyForm">
            <div class="form-group">
              <label class="form-label">Disaster</label>
              <select class="form-select" id="verifyDisasterId" required>
                <option value="">Select disaster...</option>
              </select>
            </div>
            <div class="form-group">
              <label class="form-label">Image URL</label>
              <input class="form-input" id="verifyImageUrl" placeholder="https://example.com/disaster-photo.jpg" required>
            </div>
            <div class="form-group">
              <label class="form-label">Report ID (optional)</label>
              <input class="form-input" id="verifyReportId" placeholder="Report UUID">
            </div>
            <button type="submit" class="btn btn-primary">ğŸ” Verify Image</button>
          </form>
          <div id="verifyResult"></div>
        </div>
        <div class="card">
          <div class="card-header">
            <div class="card-title">ğŸ“¸ Preview</div>
          </div>
          <div id="imagePreview" style="text-align:center;">
            <div class="empty-state"><div class="empty-state-icon">ğŸ“¸</div><div class="empty-state-text">Enter an image URL to preview</div></div>
          </div>
        </div>
      </div>
    </section>

  </main>

  <script src="app.js"></script>
</body>
</html>
